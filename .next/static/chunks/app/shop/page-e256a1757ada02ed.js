(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[21],{3460:function(e,t,s){Promise.resolve().then(s.bind(s,7257))},7257:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}});var r=s(7437),l=s(2265),n=s(6847),a=s(3698);function i(e){let{onFilterChange:t}=e,[s,n]=(0,l.useState)({category:"",city:"",country:"",listingType:"",search:""}),i=(e,r)=>{let l={...s,[e]:r};n(l),t(l)};return(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-md mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Filter Products"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),(0,r.jsx)("input",{type:"text",id:"search",value:s.search,onChange:e=>i("search",e.target.value),placeholder:"Search products...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,r.jsxs)("select",{id:"category",value:s.category,onChange:e=>i("category",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"",children:"All Categories"}),a.H.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"listingType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Listing Type"}),(0,r.jsxs)("select",{id:"listingType",value:s.listingType,onChange:e=>i("listingType",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"",children:"All Types"}),(0,r.jsx)("option",{value:"fixed",children:"Fixed Price"}),(0,r.jsx)("option",{value:"rfq",children:"Request for Quote"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),(0,r.jsx)("input",{type:"text",id:"city",value:s.city,onChange:e=>i("city",e.target.value),placeholder:"Any city",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"country",className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),(0,r.jsx)("input",{type:"text",id:"country",value:s.country,onChange:e=>i("country",e.target.value),placeholder:"Any country",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)("button",{onClick:()=>{let e={category:"",city:"",country:"",listingType:"",search:""};n(e),t(e)},className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800",children:"Clear All Filters"})})]})}function o(){let[e,t]=(0,l.useState)([]),[s,a]=(0,l.useState)([]),[o,c]=(0,l.useState)(!0),[d,u]=(0,l.useState)({category:"",city:"",country:"",listingType:"",search:""});(0,l.useEffect)(()=>{h()},[]),(0,l.useEffect)(()=>{g()},[e,d]);let h=async()=>{try{let e=await fetch("/api/products");if(e.ok){let s=await e.json();t(s)}}catch(e){console.error("Error fetching products:",e)}finally{c(!1)}},g=()=>{let t=[...e];d.search&&(t=t.filter(e=>e.name.toLowerCase().includes(d.search.toLowerCase())||e.description.toLowerCase().includes(d.search.toLowerCase()))),d.category&&(t=t.filter(e=>e.category===d.category)),d.listingType&&(t=t.filter(e=>e.listingType===d.listingType)),d.city&&(t=t.filter(e=>{var t;return null===(t=e.location)||void 0===t?void 0:t.city.toLowerCase().includes(d.city.toLowerCase())})),d.country&&(t=t.filter(e=>{var t;return null===(t=e.location)||void 0===t?void 0:t.country.toLowerCase().includes(d.country.toLowerCase())})),a(t)};return o?(0,r.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,r.jsx)("div",{className:"text-center",children:"Loading products..."})}):(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"Oil & Gas Equipment Marketplace"}),(0,r.jsx)(i,{onFilterChange:e=>{u(e)}}),(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsxs)("p",{className:"text-gray-600",children:["Showing ",s.length," of ",e.length," products"]})}),0===s.length?(0,r.jsx)("div",{className:"text-center py-12",children:(0,r.jsx)("p",{className:"text-gray-500",children:"No products found matching your criteria."})}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:s.map(e=>(0,r.jsx)(n.default,{product:e},e.id))})]})}},6847:function(e,t,s){"use strict";s.d(t,{default:function(){return i}});var r=s(7437),l=s(2265),n=s(7138),a=s(5800);function i(e){let{product:t}=e,[s,i]=(0,l.useState)(null),[o,c]=(0,l.useState)(!1),[d,u]=(0,l.useState)(!1);(0,l.useEffect)(()=>{!async function(){var e;let s=await (0,a.Ss)();i((null==s?void 0:s.user)||null),(null==s?void 0:null===(e=s.user)||void 0===e?void 0:e.bookmarks)&&c(s.user.bookmarks.includes(t.id))}()},[t.id]);let h=async e=>{if(e.preventDefault(),e.stopPropagation(),s&&"buyer"===s.role){u(!0);try{(await fetch("/api/user/bookmarks",{method:o?"DELETE":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:t.id})})).ok&&c(!o)}catch(e){console.error("Bookmark error:",e)}finally{u(!1)}}};return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(n.default,{href:"/product/".concat(t.id),children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow",children:[t.images&&t.images.length>0&&(0,r.jsx)("img",{src:t.images[0],alt:t.name,className:"w-full h-48 object-cover"}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2 line-clamp-2",children:t.name}),(0,r.jsx)("p",{className:"text-gray-600 text-sm mb-2 line-clamp-2",children:t.description}),t.tags&&t.tags.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap gap-1 mb-2",children:t.tags.slice(0,3).map((e,t)=>(0,r.jsx)("span",{className:"bg-gray-100 text-gray-600 text-xs px-2 py-1 rounded",children:e},t))}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("span",{className:"text-lg font-bold text-blue-600",children:["$",t.price.toLocaleString()]}),null!==t.stock&&(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:t.stock>0?"".concat(t.stock," in stock"):"Out of stock"})]}),(0,r.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-md text-sm hover:bg-blue-700",children:"View Details"})]})]})]})}),(null==s?void 0:s.role)==="buyer"&&(0,r.jsx)("button",{onClick:h,disabled:d,className:"absolute top-2 right-2 p-2 rounded-full transition-colors ".concat(o?"bg-blue-600 text-white":"bg-white text-gray-400 hover:text-gray-600"," shadow-md hover:shadow-lg disabled:opacity-50"),title:o?"Remove from saved":"Save for later",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z",clipRule:"evenodd"})})})]})}},5800:function(e,t,s){"use strict";async function r(){try{let e=await fetch("/api/auth/session");if(!e.ok)return null;return await e.json()}catch(e){return null}}async function l(){let e=await r();if(!e)throw window.location.href="/login",Error("Authentication required");return e}async function n(e){let t=await l();if(!e.includes(t.user.role))throw window.location.href="/dashboard",Error("Insufficient permissions");return t}s.d(t,{Hw:function(){return n},Ss:function(){return r}})},3698:function(e,t,s){"use strict";s.d(t,{H:function(){return r}});let r=["Flanges","Rope Access Equipment","Subsea Connectors","Pipe Cleaning Tools","Pressure Testing Units","Rental Tanks","Measurement & Instrumentation"]},7138:function(e,t,s){"use strict";s.d(t,{default:function(){return l.a}});var r=s(231),l=s.n(r)}},function(e){e.O(0,[231,971,23,744],function(){return e(e.s=3460)}),_N_E=e.O()}]);