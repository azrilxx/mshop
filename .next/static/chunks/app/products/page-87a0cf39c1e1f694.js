(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[286],{2235:function(e,t,s){Promise.resolve().then(s.bind(s,4799)),Promise.resolve().then(s.bind(s,6847)),Promise.resolve().then(s.t.bind(s,231,23))},6847:function(e,t,s){"use strict";s.d(t,{default:function(){return l}});var n=s(7437),a=s(2265),r=s(7138),i=s(5800);function l(e){let{product:t}=e,[s,l]=(0,a.useState)(null),[o,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(!1);(0,a.useEffect)(()=>{!async function(){var e;let s=await (0,i.Ss)();l((null==s?void 0:s.user)||null),(null==s?void 0:null===(e=s.user)||void 0===e?void 0:e.bookmarks)&&c(s.user.bookmarks.includes(t.id))}()},[t.id]);let h=async e=>{if(e.preventDefault(),e.stopPropagation(),s&&"buyer"===s.role){u(!0);try{(await fetch("/api/user/bookmarks",{method:o?"DELETE":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:t.id})})).ok&&c(!o)}catch(e){console.error("Bookmark error:",e)}finally{u(!1)}}};return(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(r.default,{href:"/product/".concat(t.id),children:(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow",children:[t.images&&t.images.length>0&&(0,n.jsx)("img",{src:t.images[0],alt:t.name,className:"w-full h-48 object-cover"}),(0,n.jsxs)("div",{className:"p-4",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2 line-clamp-2",children:t.name}),(0,n.jsx)("p",{className:"text-gray-600 text-sm mb-2 line-clamp-2",children:t.description}),t.tags&&t.tags.length>0&&(0,n.jsx)("div",{className:"flex flex-wrap gap-1 mb-2",children:t.tags.slice(0,3).map((e,t)=>(0,n.jsx)("span",{className:"bg-gray-100 text-gray-600 text-xs px-2 py-1 rounded",children:e},t))}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("span",{className:"text-lg font-bold text-blue-600",children:["$",t.price.toLocaleString()]}),null!==t.stock&&(0,n.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:t.stock>0?"".concat(t.stock," in stock"):"Out of stock"})]}),(0,n.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-md text-sm hover:bg-blue-700",children:"View Details"})]})]})]})}),(null==s?void 0:s.role)==="buyer"&&(0,n.jsx)("button",{onClick:h,disabled:d,className:"absolute top-2 right-2 p-2 rounded-full transition-colors ".concat(o?"bg-blue-600 text-white":"bg-white text-gray-400 hover:text-gray-600"," shadow-md hover:shadow-lg disabled:opacity-50"),title:o?"Remove from saved":"Save for later",children:(0,n.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z",clipRule:"evenodd"})})})]})}},5800:function(e,t,s){"use strict";async function n(){try{let e=await fetch("/api/auth/session");if(!e.ok)return null;return await e.json()}catch(e){return null}}async function a(){let e=await n();if(!e)throw window.location.href="/login",Error("Authentication required");return e}async function r(e){let t=await a();if(!e.includes(t.user.role))throw window.location.href="/dashboard",Error("Insufficient permissions");return t}s.d(t,{Hw:function(){return r},Ss:function(){return n}})}},function(e){e.O(0,[231,799,971,23,744],function(){return e(e.s=2235)}),_N_E=e.O()}]);