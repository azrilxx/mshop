(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[142],{6026:function(e,t,r){Promise.resolve().then(r.bind(r,1579))},1579:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var a=r(7437),s=r(2265),n=r(6463),i=r(7138),d=r(1426);function o(e){let{feature:t}=e,{plan:r,usage:s,featureAccess:n,loading:o}=(0,d.R9)();if(o||!r||!s||!n)return null;let l=(()=>{switch(t){case"products":return{current:s.productsCreated,limit:"Premium"===r.tier?"∞":"Standard"===r.tier?"30":"5",remaining:n.remainingProducts,canUse:n.canCreateProducts};case"ads":return{current:s.adsCreated,limit:"Premium"===r.tier?"∞":"Standard"===r.tier?"12":"0",remaining:n.remainingAdSlots,canUse:n.canCreateAds};case"reports":return{current:s.reportsGenerated,limit:"Premium"===r.tier?"∞":"Standard"===r.tier?"30":"0",remaining:n.remainingReports,canUse:n.canAccessReports}}})(),c="number"==typeof l.remaining&&l.remaining<=.19999999999999996*parseInt(l.limit);return l.canUse&&!c?null:(0,a.jsx)("div",{className:"rounded-lg p-4 mb-6 ".concat(l.canUse?"bg-yellow-50 border border-yellow-200":"bg-red-50 border border-red-200"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold ".concat(l.canUse?"text-yellow-900":"text-red-900"),children:l.canUse?"".concat(t.charAt(0).toUpperCase()+t.slice(1)," Usage Warning"):"".concat(t.charAt(0).toUpperCase()+t.slice(1)," Limit Reached")}),(0,a.jsx)("p",{className:"text-sm ".concat(l.canUse?"text-yellow-700":"text-red-700"),children:l.canUse?"You've used ".concat(l.current,"/").concat(l.limit," ").concat(t," this month (").concat(l.remaining," remaining)"):"You've used ".concat(l.current,"/").concat(l.limit," ").concat(t," this month on your ").concat(r.tier," plan")}),(0,a.jsx)("p",{className:"text-sm mt-1 ".concat(l.canUse?"text-yellow-700":"text-red-700"),children:n.upgradeMessage})]}),(0,a.jsx)(i.default,{href:"/seller/plan",className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat(l.canUse?"bg-yellow-600 hover:bg-yellow-700 text-white":"bg-red-600 hover:bg-red-700 text-white"),children:"Premium"===r.tier?"Manage Plan":"Upgrade Plan"})]})})}function l(){let[e,t]=(0,s.useState)([]),[r,d]=(0,s.useState)(null),[l,c]=(0,s.useState)({productId:"",imageUrl:"",title:"",description:"",durationDays:7}),[u,m]=(0,s.useState)(!0),[p,x]=(0,s.useState)(!1),[h,f]=(0,s.useState)(""),g=(0,n.useRouter)();(0,s.useEffect)(()=>{b()},[]);let b=async()=>{try{let[e,r]=await Promise.all([fetch("/api/products?merchantId=current"),fetch("/api/plan")]);if(e.ok){let r=await e.json();t(r)}if(r.ok){let e=await r.json();d(e)}}catch(e){f(e.message)}finally{m(!1)}},y=async e=>{e.preventDefault(),x(!0),f("");try{let e=await fetch("/api/ads",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to create ad");g.push("/seller/ads")}catch(e){f(e.message)}finally{x(!1)}},j=e=>{let{name:t,value:r}=e.target;c(e=>({...e,[t]:"durationDays"===t?parseInt(r):r}))};return u?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-gray-600",children:"Loading..."})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsx)("div",{className:"max-w-2xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"px-4 py-6 sm:px-0",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)(i.default,{href:"/seller/ads",className:"text-blue-600 hover:text-blue-800",children:"← Back to Ads"})}),(0,a.jsx)(o,{feature:"ads"}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"Create Advertisement"}),r&&(0,a.jsxs)("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"font-semibold text-blue-900",children:"Ad Slot Usage"}),(0,a.jsxs)("p",{className:"text-blue-700",children:[r.adSlotsUsed,"/",r.maxAdSlots," slots used on ",r.tier," plan"]}),0===r.maxAdSlots&&(0,a.jsxs)("p",{className:"text-red-600 mt-2",children:["Your plan doesn't include ad slots. ",(0,a.jsx)(i.default,{href:"/seller/plan",className:"underline",children:"Upgrade now"})]})]}),(0,a.jsx)("div",{className:"bg-white shadow sm:rounded-lg",children:(0,a.jsx)("div",{className:"px-4 py-5 sm:p-6",children:(0,a.jsxs)("form",{onSubmit:y,className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"productId",className:"block text-sm font-medium text-gray-700",children:"Select Product"}),(0,a.jsxs)("select",{name:"productId",id:"productId",required:!0,value:l.productId,onChange:j,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"",children:"Choose a product"}),e.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," - $",e.price]},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"Ad Title"}),(0,a.jsx)("input",{type:"text",name:"title",id:"title",required:!0,value:l.title,onChange:j,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Ad Description"}),(0,a.jsx)("textarea",{name:"description",id:"description",required:!0,rows:3,value:l.description,onChange:j,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"imageUrl",className:"block text-sm font-medium text-gray-700",children:"Banner Image URL"}),(0,a.jsx)("input",{type:"url",name:"imageUrl",id:"imageUrl",required:!0,value:l.imageUrl,onChange:j,placeholder:"https://example.com/banner.jpg",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"durationDays",className:"block text-sm font-medium text-gray-700",children:"Duration (Days)"}),(0,a.jsxs)("select",{name:"durationDays",id:"durationDays",value:l.durationDays,onChange:j,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:7,children:"7 days"}),(0,a.jsx)("option",{value:14,children:"14 days"}),(0,a.jsx)("option",{value:30,children:"30 days"})]})]}),h&&(0,a.jsx)("div",{className:"text-red-600 text-sm",children:h}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,a.jsx)(i.default,{href:"/seller",className:"bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:p||!!r&&r.adSlotsUsed>=r.maxAdSlots,className:"bg-blue-600 py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white hover:bg-blue-700 disabled:opacity-50",children:p?"Creating...":"Create Ad"})]})]})})})]})})})}},1426:function(e,t,r){"use strict";r.d(t,{getPlanAccess:function(){return m},yN:function(){return p},R9:function(){return u}});var a=r(2265);let s={Free:{maxProducts:5,maxAds:0,maxReports:0,hasAdvancedAnalytics:!1,hasPrioritySupport:!1,hasUnlimitedFeatures:!1},Standard:{maxProducts:30,maxAds:12,maxReports:30,hasAdvancedAnalytics:!0,hasPrioritySupport:!1,hasUnlimitedFeatures:!1},Premium:{maxProducts:-1,maxAds:-1,maxReports:-1,hasAdvancedAnalytics:!0,hasPrioritySupport:!0,hasUnlimitedFeatures:!0}};function n(e,t){let r=s[e];return -1===r.maxProducts||t<r.maxProducts}function i(e,t){let r=s[e];return -1===r.maxAds||t<r.maxAds}function d(e,t){let r=s[e];return -1===r.maxReports||t<r.maxReports}function o(e,t){let r=s[e];return -1===r.maxProducts?1/0:Math.max(0,r.maxProducts-t)}function l(e,t){let r=s[e];return -1===r.maxAds?1/0:Math.max(0,r.maxAds-t)}function c(e,t){let r=s[e];return -1===r.maxReports?1/0:Math.max(0,r.maxReports-t)}function u(){let[e,t]=(0,a.useState)(null),[r,s]=(0,a.useState)(null),[u,m]=(0,a.useState)(!0),[p,x]=(0,a.useState)(null);(0,a.useEffect)(()=>{h()},[]);let h=async()=>{try{m(!0);let[e,r]=await Promise.all([fetch("/api/plan"),fetch("/api/plan/usage")]);if(!e.ok||!r.ok)throw Error("Failed to fetch plan data");let a=await e.json(),n=await r.json();t(a),s(n)}catch(e){x(e.message)}finally{m(!1)}},f=e&&r?{canCreateProducts:n(e.tier,r.productsCreated),canCreateAds:i(e.tier,r.adsCreated),canAccessReports:d(e.tier,r.reportsGenerated),canAccessMassShipment:"Standard"===e.tier||"Premium"===e.tier,canAccessPrioritySupport:"Premium"===e.tier,hasAdSlotsAvailable:i(e.tier,r.adsCreated),hasProductSlotsAvailable:n(e.tier,r.productsCreated),remainingProducts:o(e.tier,r.productsCreated),remainingAdSlots:l(e.tier,r.adsCreated),remainingReports:c(e.tier,r.reportsGenerated),upgradeMessage:"Free"===e.tier?"Upgrade to Standard for 30 products and 12 ads per month":"Standard"===e.tier?"Upgrade to Premium for unlimited products and ads":"You have unlimited access to all features"}:null;return{plan:e,usage:r,featureAccess:f,loading:u,error:p,refetch:h}}function m(e){let t=s[e];return{canCreateProducts:t=>n(e,t),getProductLimit:()=>t.maxProducts,getRemainingProducts:t=>o(e,t),canCreateAds:t=>i(e,t),getAdLimit:()=>t.maxAds,getRemainingAds:t=>l(e,t),canAccessReports:t=>d(e,t),getReportLimit:()=>t.maxReports,getRemainingReports:t=>c(e,t),hasFeature:r=>({shipment:"Standard"===e||"Premium"===e,analytics:t.hasAdvancedAnalytics,priority_support:t.hasPrioritySupport,ads:t.maxAds>0,reports:t.maxReports>0})[r]||!1,getPlanLimits:()=>t,isUnlimited:e=>-1===({products:t.maxProducts,ads:t.maxAds,reports:t.maxReports})[e]}}function p(e){let[t,r]=(0,a.useState)(!1),[s,n]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{(async function(){try{r(!0)}catch(e){r(!1)}finally{n(!1)}})()},[e]),{hasAccess:t,loading:s}}},7138:function(e,t,r){"use strict";r.d(t,{default:function(){return s.a}});var a=r(231),s=r.n(a)},6463:function(e,t,r){"use strict";var a=r(1169);r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})}},function(e){e.O(0,[231,971,23,744],function(){return e(e.s=6026)}),_N_E=e.O()}]);