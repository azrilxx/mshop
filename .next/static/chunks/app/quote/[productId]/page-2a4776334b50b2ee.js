(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[827],{3182:function(e,s,r){Promise.resolve().then(r.bind(r,3727))},3727:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return n}});var l=r(7437),a=r(2265),t=r(6463),d=r(4799),i=r(5800);function n(e){var s;let{params:r}=e,[n,o]=(0,a.useState)(null),[c,u]=(0,a.useState)(null),[m,x]=(0,a.useState)(!0),[h,b]=(0,a.useState)(!1),[g,p]=(0,a.useState)(""),[f,y]=(0,a.useState)(!1),j=(0,t.useRouter)(),[v,N]=(0,a.useState)({name:"",email:"",quantity:1,region:"",message:""});(0,a.useEffect)(()=>{!async function(){try{let e=await (0,i.Ss)();u((null==e?void 0:e.user)||null);let s=await fetch("/api/products?id=".concat(r.productId));if(!s.ok)throw Error("Product not found");let l=(await s.json()).find(e=>e.id===r.productId);if(!l)throw Error("Product not found");o(l),(null==e?void 0:e.user)&&N(s=>({...s,email:e.user.email}))}catch(e){p(e.message)}finally{x(!1)}}()},[r.productId]);let w=async e=>{e.preventDefault(),b(!0),p("");try{let e=await fetch("/api/quotes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:r.productId,...v})});if(!e.ok){let s=await e.json();throw Error(s.error||"Failed to submit quote request")}y(!0),N({name:"",email:(null==c?void 0:c.email)||"",quantity:1,region:"",message:""}),setTimeout(()=>{j.push("/dashboard")},2e3)}catch(e){p(e.message)}finally{b(!1)}},q=e=>{let{name:s,value:r}=e.target;N(e=>({...e,[s]:"quantity"===s?parseInt(r)||1:r}))};return m?(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,l.jsx)(d.default,{user:c}),(0,l.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:(0,l.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,l.jsxs)("div",{className:"animate-pulse",children:[(0,l.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/2 mb-4"}),(0,l.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-6"}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("div",{className:"h-4 bg-gray-200 rounded"}),(0,l.jsx)("div",{className:"h-4 bg-gray-200 rounded"}),(0,l.jsx)("div",{className:"h-4 bg-gray-200 rounded"})]})]})})})]}):g&&!n?(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,l.jsx)(d.default,{user:c}),(0,l.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:(0,l.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Product Not Found"}),(0,l.jsx)("p",{className:"text-gray-600 mb-6",children:g}),(0,l.jsx)("button",{onClick:()=>j.push("/products"),className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700",children:"Browse Products"})]})})})]}):(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,l.jsx)(d.default,{user:c}),(0,l.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,l.jsx)("div",{className:"border-b border-gray-200 p-6",children:(0,l.jsxs)("div",{className:"flex items-start space-x-4",children:[(null==n?void 0:n.images)&&n.images.length>0&&(0,l.jsx)("img",{src:n.images[0],alt:n.name,className:"w-20 h-20 object-cover rounded-lg"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:null==n?void 0:n.name}),(0,l.jsxs)("p",{className:"text-lg text-blue-600 font-semibold mt-1",children:["$",null==n?void 0:null===(s=n.price)||void 0===s?void 0:s.toLocaleString()]}),(0,l.jsx)("p",{className:"text-gray-600 mt-2 line-clamp-2",children:null==n?void 0:n.description})]})]})}),(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Request Quote for this Product"}),f&&(0,l.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-md p-4 mb-6",children:(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),(0,l.jsxs)("div",{className:"ml-3",children:[(0,l.jsx)("h3",{className:"text-sm font-medium text-green-800",children:"Quote Request Submitted Successfully!"}),(0,l.jsx)("div",{className:"mt-2 text-sm text-green-700",children:(0,l.jsx)("p",{children:"Your quote request has been sent to the seller. You'll be redirected to your dashboard shortly."})})]})]})}),g&&(0,l.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 mb-6",children:(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,l.jsxs)("div",{className:"ml-3",children:[(0,l.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Error submitting quote request"}),(0,l.jsx)("div",{className:"mt-2 text-sm text-red-700",children:(0,l.jsx)("p",{children:g})})]})]})}),(0,l.jsxs)("form",{onSubmit:w,className:"space-y-6",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Full Name *"}),(0,l.jsx)("input",{type:"text",id:"name",name:"name",required:!0,value:v.name,onChange:q,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Your full name"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email Address *"}),(0,l.jsx)("input",{type:"email",id:"email",name:"email",required:!0,value:v.email,onChange:q,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"your.email@company.com"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"quantity",className:"block text-sm font-medium text-gray-700",children:"Quantity *"}),(0,l.jsx)("input",{type:"number",id:"quantity",name:"quantity",required:!0,min:"1",value:v.quantity,onChange:q,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"region",className:"block text-sm font-medium text-gray-700",children:"Delivery Region *"}),(0,l.jsx)("input",{type:"text",id:"region",name:"region",required:!0,value:v.region,onChange:q,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Texas, USA or Middle East"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700",children:"Additional Requirements *"}),(0,l.jsx)("textarea",{id:"message",name:"message",required:!0,rows:4,value:v.message,onChange:q,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Please describe your specific requirements, timeline, certification needs, or any other details..."})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,l.jsx)("button",{type:"button",onClick:()=>j.back(),className:"px-6 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,l.jsx)("button",{type:"submit",disabled:h,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:h?"Submitting...":"Submit Quote Request"})]})]})]})]})})]})}},5800:function(e,s,r){"use strict";async function l(){try{let e=await fetch("/api/auth/session");if(!e.ok)return null;return await e.json()}catch(e){return null}}async function a(){let e=await l();if(!e)throw window.location.href="/login",Error("Authentication required");return e}async function t(e){let s=await a();if(!e.includes(s.user.role))throw window.location.href="/dashboard",Error("Insufficient permissions");return s}r.d(s,{Hw:function(){return t},Ss:function(){return l}})}},function(e){e.O(0,[231,799,971,23,744],function(){return e(e.s=3182)}),_N_E=e.O()}]);