(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[331],{2133:function(e,t,a){Promise.resolve().then(a.bind(a,5685))},5685:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return c}});var s=a(7437),r=a(2265),i=a(6463),n=a(5800),l=a(7293);function c(){let[e,t]=(0,r.useState)(null),[a,c]=(0,r.useState)([]),[o,d]=(0,r.useState)(!0),[m,u]=(0,r.useState)(!1),[g,x]=(0,r.useState)(null),[h,b]=(0,r.useState)({name:"",description:"",imageUrl:""}),p=(0,i.useRouter)();(0,r.useEffect)(()=>{y()},[]);let y=async()=>{try{let e=await (0,n.Hw)(["admin"]);t(e),await f()}catch(e){console.error("Auth check failed:",e),p.push("/login")}},f=async()=>{try{let e=await l.WN.getAll();c(e)}catch(e){console.error("Failed to load categories:",e)}finally{d(!1)}},j=async e=>{e.preventDefault();try{g?await fetch("/api/admin/categories",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:g.id,...h})}):await fetch("/api/admin/categories",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)}),b({name:"",description:"",imageUrl:""}),u(!1),x(null),await f()}catch(e){console.error("Failed to save category:",e)}},N=e=>{x(e),b({name:e.name,description:e.description||"",imageUrl:e.imageUrl||""}),u(!0)},v=async e=>{if(confirm("Are you sure you want to archive this category?"))try{await fetch("/api/admin/categories",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})}),await f()}catch(e){console.error("Failed to archive category:",e)}};return o?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-lg",children:"Loading..."})}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,s.jsxs)("div",{className:"mb-8 flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Category Management"}),(0,s.jsx)("p",{className:"text-gray-600 mt-2",children:"Manage product categories"})]}),(0,s.jsx)("button",{onClick:()=>u(!m),className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors",children:m?"Cancel":"Add Category"})]}),m&&(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:g?"Edit Category":"Add New Category"}),(0,s.jsxs)("form",{onSubmit:j,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),(0,s.jsx)("input",{type:"text",required:!0,value:h.name,onChange:e=>b({...h,name:e.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,s.jsx)("textarea",{value:h.description,onChange:e=>b({...h,description:e.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Image URL"}),(0,s.jsx)("input",{type:"url",value:h.imageUrl,onChange:e=>b({...h,imageUrl:e.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsx)("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors",children:g?"Update":"Create"}),(0,s.jsx)("button",{type:"button",onClick:()=>{u(!1),x(null),b({name:"",description:"",imageUrl:""})},className:"bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"})]})]})]}),(0,s.jsx)("div",{className:"grid gap-4",children:a.map(e=>(0,s.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[e.imageUrl&&(0,s.jsx)("img",{src:e.imageUrl,alt:e.name,className:"w-16 h-16 object-cover rounded-lg"}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:[e.name,e.archived&&(0,s.jsx)("span",{className:"ml-2 text-xs bg-red-100 text-red-800 px-2 py-1 rounded",children:"Archived"})]}),e.description&&(0,s.jsx)("p",{className:"text-gray-600",children:e.description})]})]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("button",{onClick:()=>N(e),className:"bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600 transition-colors",children:"Edit"}),!e.archived&&(0,s.jsx)("button",{onClick:()=>v(e.id),className:"bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600 transition-colors",children:"Archive"})]})]})},e.id))})]})})}}},function(e){e.O(0,[218,77,134,971,23,744],function(){return e(e.s=2133)}),_N_E=e.O()}]);