(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[375],{1060:function(e,t,s){Promise.resolve().then(s.bind(s,8646))},8646:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return d}});var a=s(7437),r=s(2265),n=s(6463),i=s(5800),c=s(7293);function d(){let[e,t]=(0,r.useState)(null),[s,d]=(0,r.useState)([]),[l,o]=(0,r.useState)(!0),m=(0,n.useRouter)();(0,r.useEffect)(()=>{x()},[]);let x=async()=>{try{let e=await (0,i.Hw)(["admin"]);t(e),await p()}catch(e){console.error("Auth check failed:",e),m.push("/login")}},p=async()=>{try{let e=await c.fN.getAll(),t=await Promise.all(e.map(async e=>{let t=await c.Up.findById(e.productId);return{...e,product:t}}));d(t)}catch(e){console.error("Failed to load reports:",e)}finally{o(!1)}},u=async(e,t)=>{try{await fetch("/api/admin/reports",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:e,reportId:t,action:"reviewed"})}),await p()}catch(e){console.error("Failed to mark report as reviewed:",e)}},h=async(e,t)=>{if(confirm("Are you sure you want to suspend this listing?"))try{await fetch("/api/admin/reports",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:e,reportId:t,action:"suspend"})}),await p()}catch(e){console.error("Failed to suspend listing:",e)}};return l?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-lg",children:"Loading..."})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Abuse Reports"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"Review and manage reported listings"})]}),0===s.filter(e=>"pending"===e.status).length?(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Pending Reports"}),(0,a.jsx)("p",{className:"text-gray-500",children:"All reports have been reviewed."})]}):(0,a.jsx)("div",{className:"grid gap-6",children:s.filter(e=>"pending"===e.status).map(e=>{var t;return(0,a.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,a.jsx)("span",{className:"bg-red-100 text-red-800 text-xs font-medium px-2.5 py-0.5 rounded",children:e.category}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString()})]}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:(null===(t=e.product)||void 0===t?void 0:t.name)||"Product Not Found"}),(0,a.jsx)("p",{className:"text-gray-700 mb-3",children:e.description}),e.contact&&(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Reporter contact: ",e.contact]}),e.product&&(0,a.jsxs)("div",{className:"mt-4 p-3 bg-gray-50 rounded",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Product: ",e.product.name," - $",e.product.price]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Seller: ",e.product.merchantId]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col space-y-2 ml-6",children:[(0,a.jsx)("button",{onClick:()=>u(e.productId,e.id),className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors text-sm",children:"Mark Reviewed"}),(0,a.jsx)("button",{onClick:()=>h(e.productId,e.id),className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors text-sm",children:"Suspend Listing"})]})]})},"".concat(e.productId,"-").concat(e.id))})})]})})}}},function(e){e.O(0,[218,77,134,971,23,744],function(){return e(e.s=1060)}),_N_E=e.O()}]);