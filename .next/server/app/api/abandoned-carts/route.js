"use strict";(()=>{var e={};e.id=7369,e.ids=[7369],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},32081:e=>{e.exports=require("child_process")},6113:e=>{e.exports=require("crypto")},9523:e=>{e.exports=require("dns")},82361:e=>{e.exports=require("events")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},41808:e=>{e.exports=require("net")},22037:e=>{e.exports=require("os")},71017:e=>{e.exports=require("path")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},93713:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>h,patchFetch:()=>y,requestAsyncStorage:()=>q,routeModule:()=>m,serverHooks:()=>b,staticGenerationAsyncStorage:()=>g});var s={};t.r(s),t.d(s,{GET:()=>c,PATCH:()=>x,POST:()=>l});var a=t(49303),n=t(88716),o=t(60670),i=t(87070),u=t(9487),p=t(90455),d=t(64717);async function c(e){try{await (0,p.MH)(["admin"]);let e=await u.cartDb.getAbandonedCarts(),r=await Promise.all(e.map(async({userId:e,cart:r})=>{let t=await u.userDb.findByEmail(e);return{userId:e,user:t?{email:t.email,role:t.role}:null,cart:r,itemCount:r.items.length,lastUpdated:r.updatedAt}}));return i.NextResponse.json(r)}catch(e){return i.NextResponse.json({error:e.message||"Failed to fetch abandoned carts"},{status:500})}}async function l(e){try{await (0,p.MH)(["admin"]);let{userId:r,markReminderSent:t}=await e.json();if(!r||"boolean"!=typeof t)return i.NextResponse.json({error:"User ID and markReminderSent flag are required"},{status:400});let s=await u.cartDb.get(r);return s.reminderSent=t,await u.cartDb.update(r,s),i.NextResponse.json({message:"Cart reminder status updated"})}catch(e){return i.NextResponse.json({error:e.message||"Failed to update cart reminder status"},{status:500})}}async function x(e){try{return await d.BF.processAbandonedCarts(),i.NextResponse.json({message:"Abandoned cart reminders processed successfully"})}catch(e){return i.NextResponse.json({error:e.message||"Failed to process abandoned cart reminders"},{status:500})}}let m=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/abandoned-carts/route",pathname:"/api/abandoned-carts",filename:"route",bundlePath:"app/api/abandoned-carts/route"},resolvedPagePath:"/home/runner/workspace/app/api/abandoned-carts/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:q,staticGenerationAsyncStorage:g,serverHooks:b}=m,h="/api/abandoned-carts/route";function y(){return(0,o.patchFetch)({serverHooks:b,staticGenerationAsyncStorage:g})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[8948,741,1615,2964,5972,5245,9487,2094],()=>t(93713));module.exports=s})();